{% extends "base.html" %}
{% block title %}–î–µ–¥–ª–∞–π–Ω—ã{% endblock %}

{% block content %}
<div class="bg-white rounded-2xl shadow p-6">
  <div class="flex items-center justify-between mb-4">
    <h1 class="text-2xl font-bold">–î–µ–¥–ª–∞–π–Ω—ã</h1>
    <a href="{{ url_for('admin_add_deadline') }}"
       class="px-3 py-2 rounded bg-gray-900 text-white hover:bg-black">+ –ù–æ–≤—ã–π –¥–µ–¥–ª–∞–π–Ω</a>
  </div>
 
  {% if items %}
  <table class="w-full text-sm">
    <thead>
      <tr class="text-gray-500">
        <th class="text-left py-2">–î–∞—Ç–∞/–≤—Ä–µ–º—è</th>
        <th class="text-left py-2">–¢–∏–ø</th>
        <th class="text-left py-2">–ü—Ä–µ–¥–º–µ—Ç</th>
        <th class="text-left py-2">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th class="text-left py-2"></th>
      </tr>
    </thead>
    <tbody>
      {% for d in items %}
      <tr class="border-t">
        <td class="py-2">
          {% if d.all_day %}
            {{ d.due_at.strftime("%Y-%m-%d") }} <span class="text-gray-400">(–≤–µ—Å—å –¥–µ–Ω—å)</span>
          {% else %}
            {{ d.due_at.strftime("%Y-%m-%d %H:%M") }}
          {% endif %}
        </td>
        <td class="py-2">
          <span class="px-2 py-1 rounded-full text-xs border">
            {{ d.kind|capitalize }}
          </span>
        </td>
        <td class="py-2">{{ d.subject or "‚Äî" }}</td>
        <td class="py-2">{{ d.title }}</td>
        <td class="py-2 text-right">

          {% if d.file_path %}
          <a class="px-2 py-1 rounded border hover:bg-gray-50"
             href="{{ url_for('download_attachment', fname=d.file_path) }}"
             title="–°–∫–∞—á–∞—Ç—å –≤–ª–æ–∂–µ–Ω–∏–µ">üìé</a>
          {% endif %}

          <a href="{{ url_for('admin_deadline_edit', deadline_id=d.id) }}"
             class="px-2 py-1 rounded border hover:bg-gray-50">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>

          <form method="post" action="{{ url_for('admin_deadline_delete', deadline_id=d.id) }}"
                class="inline"
                onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –¥–µ–¥–ª–∞–π–Ω?');">
            <button class="px-2 py-1 rounded border border-red-300 text-red-600 hover:bg-red-50">
              –£–¥–∞–ª–∏—Ç—å
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p class="text-gray-600">–ü–æ–∫–∞ –Ω–µ—Ç –¥–µ–¥–ª–∞–π–Ω–æ–≤.</p>
  {% endif %}
</div>
{% endblock %}
